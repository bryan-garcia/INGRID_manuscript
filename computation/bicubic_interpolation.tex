\subsection{\label{sec:level2}Bicubic interpolation and line tracing}
The input data for the poloidal magnetic flux $\Psi$ are sampled on
rectilinear grid in $R,Z$, from an MHD reconstruction code like EFIT
or a similar one. INGRID utilizes bicubic interpolation for obtaining
the values of the poloidal magnetic flux $\Psi$ and its derivatives
between data points of a provided magnetic equilibrium. INGRID
calculations involve solving differential equations that require a
continuous $\psi, \psi'_{z}, \psi'_{r}, \psi''_{rz}$. Bicubic
interpolation is robust, preserves continuity and smoothness at the
edges of cells, and provides the accuracy required for modeling
divertor configurations with small poloidal magnetic field values and
low neqdsk resolution. For our use of bicubic interpolation, the
derivatives $\Psi'_{z}, \Psi'_{r}, \Psi''_{rz}$ are evaluated at the
grid points using finite difference approximation. After that, $\Psi$
is reconstructed inside the cell defined by four EFIT grid points.

Flux surfaces are reconstructed in INGRID by integrating the ODEs,

\beq
%
\dot{R} = -\frac{1}{R}\psi_{z} \quad \dot{Z} = \frac{1}{R}\psi_{r}
%
\eeq

using the LSODA integrator in SciPy.

%The properties of bicubic interpolation are: (i) values of the
%function and the specified derivatives are reproduced exactly on the
%grid points, and (ii) values of the function and the specified
%derivatives change continuously as the interpolating point crosses
%from one grid square to another \cite{Press_1992}. Therefore flux
%surfaces, based on the bicubic interpolation, are smooth.

Since bicubic interpolation gurantees continuity of $\Psi'_{z},
\Psi'_{r}$ as the interpolating point crosses from one grid square to
another \cite{Press_1992}, flux surfaces based on the bicubic
interpolation are smooth.

%\beq
%%
%\dot{R} = \frac{1}{R}\psi_{z} \quad \dot{Z} = \frac{1}{R}\psi_{z}
%%
%\eeq

\noindent
Line tracing capabilities also allow for computation of lines with
constant arbitrary slope. These line tracing capabilities allow for
the development of Patch map generation scripts. A variety of
termination criteria for line tracing are available, and include
intersection criteria such as $(r,z)$ intersection, $\psi$ value
intersection, and intersection with arbitrary INGRID ``curves"
(piecewise linear geometries).
